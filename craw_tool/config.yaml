# =============================================================================
# Crawl4AI 通用爬虫配置文件
# =============================================================================

# 目标配置
target_url: "https://papers.nips.cc/"      #"https://dl.acm.org/doi/proceedings/10.1145/3706598#heading3"  # 目标起始地址

# URL 过滤正则表达式
# 匹配 ACM 论文链接格式: https://dl.acm.org/doi/10.1145/数字.数字
regex_pattern: "^https://papers\\.nips\\.cc/paper_files/paper/\\d{4}/?$"  #"https://dl\\.acm\\.org/doi/10\\.1145/\\d+\\.\\d+"

# 动态页面展开配置
click_selector: ".accordion-tab, .section__separator"        # 需要点击展开页面的 CSS 选择器
wait_for_selector: ""               # 留空则不等待特定元素（避免超时）
max_clicks: 100                      # 最大点击次数，防止无限循环
click_delay_ms: 1500                # 每次点击后等待时间（毫秒）

# 缓存配置
cache_path: "./.crawl4ai_cache"     # 缓存存储路径
enable_cache: ture                  # 是否启用缓存

# 输出配置
output_file: "results_nips.jsonl"        # 结果存入的文件名

# 浏览器配置
browser:
  headless: false                   # 首次运行设为 false，手动通过 Cloudflare 验证后可改为 true
  verbose: true                     # 是否输出详细日志
  use_magic_mode: true              # 是否启用 Magic Mode 绕过反爬

# 爬取配置
crawler:
  timeout: 120000                   # 页面加载超时时间（毫秒），2分钟
  wait_until: "load"                # 等待策略: domcontentloaded, load, networkidle, commit
  delay_before_return: 15.0         # 返回HTML前额外等待时间（秒），等待 Cloudflare 验证完成

# 日志配置
logging:
  level: "INFO"                     # 日志级别: DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# =============================================================================
# PDF 下载配置
# =============================================================================
downloader:
  # 输入文件（之前爬取的链接列表）
  input_file: "results.jsonl"
  
  # 输出配置
  output_file: "final_papers.jsonl"   # 下载记录文件
  download_dir: "./downloads"          # PDF 存储根目录
  
  # 并发控制（降低并发避免触发 ACM 速率限制）
  max_concurrent: 1                     # 最大并发下载数（ACM 限制严格，建议 1-3）
  request_delay: 3.0                    # 每次请求间隔（秒）
  download_timeout: 120                 # 下载超时时间（秒）
  max_retries: 3                        # 失败重试次数
  retry_delay: 10.0                     # 重试等待时间（秒）
  
  # PDF 链接匹配正则
  pdf_patterns:
    - "https?://dl\\.acm\\.org/doi/pdf/[^\\s?#]+"
    - "/doi/pdf/[^\\s?#]+"

  # 年份匹配配置
  year_patterns:
    - "citation_year[^>]*content=\"(\\d{4})\""
    - "(\\d{4})\\s+(CHI|Conference|ICML|NeurIPS)"

  default_year: "Unknown"
